!function(e,t){t.c47YTIframeReady=!1,t.c47YTPlayers=[];function o(e){this.name="UltimateBackgroundException",this.message=e}function i(o,i){var a=o.outerWidth(),r=o.outerHeight();console.log("viewport height: "+e(t.top).height());var n,s,l=Math.floor(1*a/i.ratio),c=Math.floor(r*i.ratio);if("body"==i.container){var d;if("image"==i.type)return(d=Math.ceil(e(t).height()*i.ratio))<a?[a,l]:[d,e(t).height()];if("youtube"==i.type)return(d=Math.ceil(e(t).height()*i.ratio))<a?[a,l]:[d,e(t).height()]}return console.log("height: "+r+"------ calculated height"+l),console.log("width: "+a+"------ calculated width"+c),r>=l?(console.log("using original height and calculated width"),s=r,n=c):l>=r&&(console.log("using original width and calculated height"),n=a,s=l),[n,s]}e.fn.c47bg=function(a){var r=this;r.css("position","relative");a=e.extend(a,{ratio:16/9,mute:!0,repeat:!0,crop:!0}),console.log(a),console.log("tag name: ",this.prop("tagName")),"body"===this.prop("tagName").toLowerCase&&(console.log("removing padding and margin in body and html"),e("body,html").css("margin",0),e("body,html").css("padding",0));var n=i(r,a),s=n[0],l=n[1],c="c47-random-"+Math.floor(1e5*Math.random());if(a.crop&&a.container,"youtube"==a.type){var d=document.createElement("script");d.src="https://www.youtube.com/iframe_api";var h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(d,h),r.find(".c47-ultimate-bg").remove(),m='<div style="position: absolute; top: 0; left: 0; overflow: hidden; z-index: -1;" class="c47-ultimate-bg"><div style="-webkit-backface-visibility: hidden; backface-visibility: hidden;position:'+("body"==a.container?"fixed;":"absolute")+';" id="'+c+'" ></div></div>',r.prepend(m);var g=setInterval(function(){t.c47YTIframeReady&&(clearInterval(g),function(e,o,i,a){console.log("start a new player with video ID: "+o);var r=new YT.Player(e,{videoId:o,width:i,height:a,playerVars:{autoplay:1,controls:0,showinfo:0,loop:1,start:0,rel:0,modestbranding:1},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}});t.c47YTPlayers=t.c47YTPlayers||[],t.c47YTPlayers.push(r)}(c,a.source,s,l))},10);t.onYouTubeIframeAPIReady=function(){t.c47YTIframeReady=!0},t.onPlayerReady=function(e){e.target.playVideo(),e.target.mute()},t.onPlayerStateChange=function(e){if(0===e.data&&a.repeat){console.log("ok to repeat",t.c47YTPlayers.length);for(var o=0;o<t.c47YTPlayers.length;o++)console.log(t.c47YTPlayers[o].getPlayerState()),0==t.c47YTPlayers[o].getPlayerState()&&t.c47YTPlayers[o].seekTo(0)}}}else if("self-hosted"==a.type){if("object"!=typeof a.source)throw new o("The source property needs to be an object. Please go to https://github.com/datmt/ultimate-background for documentation");var p=a.source,u="",y="",f="",v="";if(void 0!==a.poster&&(u=a.poster),void 0!==p.mp4&&(y='<source src="'+p.mp4+'" type="video/mp4">'),void 0!==p.ogv&&(f='<source src="'+p.ogv+'" type="video/ogg">'),void 0!==p.webm&&(v='<source src="'+p.webm+'" type="video/webm">'),y==f==v=="")throw new o("Please provide at least one video source");var m='<div class="c47-ultimate-bg" style="z-index: -1; position: absolute; top: 0; left: 0; overflow: hidden;"><video  autoplay="1" loop="1" muted="1" id="'+c+'" height="'+l+'" width="'+s+'" poster="'+u+'" >'+y+f+v+"Your browser doesn't support HTML5 video tag.</video></div>";r.prepend(m)}else if("image"==a.type){var b='<div style="position: absolute; top: 0; left: 0; z-index: -1;" class="c47-ultimate-bg"><img style="position: '+("body"==a.container?"fixed":"absolute")+'; top: 0; left: 0;" id="'+c+'" src="'+a.source+'" /></div>';r.prepend(b)}return e(function(){var o=e(".c47-ultimate-bg"),n=void 0===a.overlayClass?"b1":a.overlayClass,c="body"==a.container?"fixed":"absolute";0==o.find(".c47-overlay").length&&o.append('<div class="c47-overlay '+n+'" style="position: '+c+"; padding: 0; margin: 0; top: 0; bottom: 0; right: 0; left: 0; width: "+s+"px; height: "+l+'px; z-index: 100;"></div>');try{e(".c47-overlay").addEventListener("touchmove",function(e){e.preventDefault()},!1),o.addEventListener("touchmove",function(e){e.preventDefault()},!1)}catch(e){}e(t).bind("resize orientationchange",function(){console.log("resizing bg...;");var o,n=i(e(this),a),s=n[0],l=n[1],c=e(r).find(".c47-ultimate-bg").first();if(c.css("height",e(r).outerHeight()),c.css("width","100%"),"youtube"==a.type)(o=c.find("iframe").first()).attr("width",s),o.attr("height",l),o.css("top",0),o.css("left",0);else if("image"==a.type){(o=c.find("img").first()).css("width",s+"px"),o.css("height",l+"px");var d=s/2-e(t).width()/2;d>0&&e(t).height()/e(t).width()>1.4?o.css("margin-left","-"+d+"px"):o.css("margin-left","0")}else"self-hosted"==a.type&&((o=c.find("video")).attr("width",s),o.attr("height",l));o.siblings(".c47-overlay").css("width",s+"px"),o.siblings(".c47-overlay").css("height",l+"px")}),e(function(){console.log("triggering rezie manually"),e(r).trigger("resize")})}),this}}(jQuery,window);